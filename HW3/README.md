# REPO LINK: [https://github.com/neal-p/CHEM279](https://github.com/neal-p/CHEM279)


# HW3

## Compilation Instructions
  1. Go to the top level repo directory `CHEM279/`
  2. `mkdir -p build`
  3. `cd build`
  4. `cmake ..`
  5. `make hw3 bond_energy`

## Run Instructions
Once you have compiled, there will be three executables:
  - `CHEM279/HW3/hw3`
  - `CHEM279/HW3/bond_energy`
  - `CHEM279/HW3/basic_rxn`


### Discussion
Here, the `hw3` executable will run an Extended Huckel calculation on the provided coordinate file (argument 1) and basis set file (argument 2). The coordinate file should be in xyz format with '<n_atoms> <charge>' as the first line and atomic numbers for the elements. The basis set file must be in Gaussian format such as pulled from the BasisSetExchange website. Note! The system must have an EVEN number of electrons.

The program reads in the information, calculates the AO overlap matrix, the Huckel hamiltonian, and finally the total energy. A few of the crucial matricies are printed in the process.

The `sample_input/` folder contains the provided sample input, as well as a test that the program properly terminates when an odd number of electrons is requested. You can execute `run_samples.sh` to run `./hw3 <file> basis_set.txt` for each sample and pipe the output to a corresponding file in `my_output`.

An example output is shown below:
`./hw3 sample_input/C2H2.txt basis_set.txt`


```
Read in the following:
Simulation: 
    n_atoms=4, charge=0, n_AOs= 10, n_e-=14, n_valence_e=10
    1       0.00000   0.00000   0.00000
    6       2.07870   0.00000   0.00000
    6       4.36530   0.00000   0.00000
    1       6.44400   0.00000   0.00000

Overlap Matrix S:
 1.00000  0.48501 -0.46382  0.00000  0.00000  0.07295 -0.09755  0.00000  0.00000  0.00740
 0.48501  1.00000  0.00000  0.00000  0.00000  0.46629 -0.45219  0.00000  0.00000  0.07295
-0.46382  0.00000  1.00000  0.00000  0.00000  0.45219 -0.31207  0.00000  0.00000  0.09755
 0.00000  0.00000  0.00000  1.00000  0.00000  0.00000  0.00000  0.29737  0.00000  0.00000
 0.00000  0.00000  0.00000  0.00000  1.00000  0.00000  0.00000  0.00000  0.29737  0.00000
 0.07295  0.46629  0.45219  0.00000  0.00000  1.00000  0.00000  0.00000  0.00000  0.48501
-0.09755 -0.45219 -0.31207  0.00000  0.00000  0.00000  1.00000  0.00000  0.00000  0.46382
 0.00000  0.00000  0.00000  0.29737  0.00000  0.00000  0.00000  1.00000  0.00000  0.00000
 0.00000  0.00000  0.00000  0.00000  0.29737  0.00000  0.00000  0.00000  1.00000  0.00000
 0.00740  0.07295  0.09755  0.00000  0.00000  0.48501  0.46382  0.00000  0.00000  1.00000

Huckel Hamiltonian Matrix H:
-13.60000 -14.85358  10.14605   0.00000   0.00000  -2.23417   2.13383   0.00000   0.00000  -0.17609
-14.85358 -21.40000   0.00000   0.00000   0.00000 -17.46245  12.97775   0.00000   0.00000  -2.23417
 10.14605   0.00000 -11.40000   0.00000   0.00000 -12.97775   6.22585   0.00000   0.00000  -2.13383
  0.00000   0.00000   0.00000 -11.40000   0.00000   0.00000   0.00000  -5.93255   0.00000   0.00000
  0.00000   0.00000   0.00000   0.00000 -11.40000   0.00000   0.00000   0.00000  -5.93255   0.00000
 -2.23417 -17.46245 -12.97775   0.00000   0.00000 -21.40000   0.00000   0.00000   0.00000 -14.85358
  2.13383  12.97775   6.22585   0.00000   0.00000   0.00000 -11.40000   0.00000   0.00000 -10.14605
  0.00000   0.00000   0.00000  -5.93255   0.00000   0.00000   0.00000 -11.40000   0.00000   0.00000
  0.00000   0.00000   0.00000   0.00000  -5.93255   0.00000   0.00000   0.00000 -11.40000   0.00000
 -0.17609  -2.23417  -2.13383   0.00000   0.00000 -14.85358 -10.14605   0.00000   0.00000 -13.60000

Matrix X:
 1.26865 -0.29295  0.39220  0.00000  0.00000 -0.08612  0.07231  0.00000  0.00000 -0.01205
-0.29295  1.48017  0.20371  0.00000  0.00000 -0.46197  0.48690  0.00000  0.00000 -0.08612
 0.39220  0.20371  1.45011  0.00000  0.00000 -0.48690  0.42301  0.00000  0.00000 -0.07231
 0.00000  0.00000  0.00000  1.03547  0.00000  0.00000  0.00000 -0.15752  0.00000  0.00000
 0.00000  0.00000  0.00000  0.00000  1.03547  0.00000  0.00000  0.00000 -0.15752  0.00000
-0.08612 -0.46197 -0.48690  0.00000  0.00000  1.48017 -0.20371  0.00000  0.00000 -0.29295
 0.07231  0.48690  0.42301  0.00000  0.00000 -0.20371  1.45011  0.00000  0.00000 -0.39220
 0.00000  0.00000  0.00000 -0.15752  0.00000  0.00000  0.00000  1.03547  0.00000  0.00000
 0.00000  0.00000  0.00000  0.00000 -0.15752  0.00000  0.00000  0.00000  1.03547  0.00000
-0.01205 -0.08612 -0.07231  0.00000  0.00000 -0.29295 -0.39220  0.00000  0.00000  1.26865

Check orthogonalizatoin X^t * S * X:
1.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000
0.00000 1.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000
0.00000 0.00000 1.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000
0.00000 0.00000 0.00000 1.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000
0.00000 0.00000 0.00000 0.00000 1.00000 0.00000 0.00000 0.00000 0.00000 0.00000
0.00000 0.00000 0.00000 0.00000 0.00000 1.00000 0.00000 0.00000 0.00000 0.00000
0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 1.00000 0.00000 0.00000 0.00000
0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 1.00000 0.00000 0.00000
0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 1.00000 0.00000
0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 0.00000 1.00000
    is identity check: 1

Matrix V: 
 0.23344  0.45938  0.43216  0.00000  0.00000  0.00000  0.00000  0.53754 -0.50867  0.00437
 0.65220  0.37966 -0.03310  0.00000  0.00000  0.00000  0.00000 -0.32851  0.27118  0.49793
 0.14192 -0.38056 -0.55870  0.00000  0.00000  0.00000  0.00000  0.32114 -0.40953  0.50204
 0.00000  0.00000  0.00000 -0.16900 -0.68661 -0.25852 -0.65815  0.00000  0.00000  0.00000
 0.00000  0.00000  0.00000 -0.68661  0.16900 -0.65815  0.25852  0.00000  0.00000  0.00000
 0.65220 -0.37966 -0.03310  0.00000  0.00000  0.00000  0.00000  0.32851  0.27118 -0.49793
-0.14192 -0.38056  0.55870  0.00000  0.00000  0.00000  0.00000  0.32114  0.40953  0.50204
 0.00000  0.00000  0.00000 -0.16900 -0.68661  0.25852  0.65815  0.00000  0.00000  0.00000
 0.00000  0.00000  0.00000 -0.68661  0.16900  0.65815 -0.25852  0.00000  0.00000  0.00000
 0.23344 -0.45938  0.43216  0.00000  0.00000  0.00000  0.00000 -0.53754 -0.50867 -0.00437

Matrix C: 
 0.09151  0.33303  0.37688  0.00000  0.00000  0.00000  0.00000  0.90554 -0.87300  0.13580
 0.53539  0.37953 -0.03931  0.00000  0.00000  0.00000  0.00000 -0.52740  0.58491  1.31286
 0.03575 -0.23725 -0.42622  0.00000  0.00000  0.00000  0.00000  0.62436 -0.66014  1.28629
 0.00000  0.00000  0.00000 -0.14837 -0.60281 -0.30841 -0.78517  0.00000  0.00000  0.00000
 0.00000  0.00000  0.00000 -0.60281  0.14837 -0.78517  0.30841  0.00000  0.00000  0.00000
 0.53539 -0.37953 -0.03931  0.00000  0.00000  0.00000  0.00000  0.52740  0.58491 -1.31286
-0.03575 -0.23725  0.42622  0.00000  0.00000  0.00000  0.00000  0.62436  0.66014  1.28629
 0.00000  0.00000  0.00000 -0.14837 -0.60281  0.30841  0.78517  0.00000  0.00000  0.00000
 0.00000  0.00000  0.00000 -0.60281  0.14837  0.78517 -0.30841  0.00000  0.00000  0.00000
 0.09151 -0.33303  0.37688  0.00000  0.00000  0.00000  0.00000 -0.90554 -0.87300 -0.13580

Orbital energies Vector E:
-26.79253
-19.63008
-15.44271
-13.35975
-13.35975
 -7.78142
 -7.78142
  6.54517
 10.46392
 56.05331

TOTAL ENERGY: 
-177.16963
```

Using the extended Huckel code, I have a program `bond_energy` that given coordinates of `H2` and a basis set will calculate the bond energy relative to infinitely separated hydrogen atoms. Below, I show the command to run this program and its output:

`./bond_energy sample_input/H2.txt basis_set.txt`


```
Computed energy of H2: -35.3099 eV
Given energy of H: -13.6 eV
H2 bond energy: -8.1099 eV
```

Lastly, I calculate the reaction enthalpy of `C2H2 + H2 -> C2H4` with the program `basic_rxn`. While my total energies for the individual components match the given expected values, our very basic EHT model doesn't give great agreement to the known enthalpy of `-174 kJ/mol`. I thought it might be a geometry problem, so visualized the structures and every so slightly tweaked the geometries, but unfortunately, it seems EHT does not capture the required interactions to model the bonding correctly. The program use and output is shown below:

`./basic_rxn basis_set.txt sample_input/C2H4.txt sample_input/C2H2.txt sample_input/H2.txt`


```
Computed energy of C2H4: -211.48 eV
Computed energy of C2H2: -177.17 eV
Computed energy of H2: -35.3099 eV
dH (C2H2 + H2 -> C2H4): 0.999345 eV or 96.4218 kJ/mol
```

